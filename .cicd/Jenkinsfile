pipeline {
  agent none
  parameters {
    string(name: 'BRANCH', defaultValue: 'develop', description: '')
  }
  
  stages {
    stage('Start Parallelworks Cluster') {
       agent {
        label 'built-in'   
       }
      steps {
        script {
          for (label in pullRequest.labels) {
            if ((label.matches("(.*)-aws"))) {
               env.CHOICE_NODE='pclusternoaav2use1'
            }  
            else if ((label.matches("(.*)-gcp"))) { 
               env.CHOICE_NODE='gclusternoaav2usc1'
            }  
            else if ((label.matches("(.*)-azure"))) {
               env.CHOICE_NODE='azclusternoaav2use1'
            }  
            else { 
               env.CHOICE_NODE='none'
            }
          }
          echo "Value of CHOICE_NODE is ${CHOICE_NODE}"
        }    
      }
    }
  }
}
